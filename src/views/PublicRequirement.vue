<template>
  <div class="public-requirement-page">
    <!-- é¡¶éƒ¨æ ‡é¢˜ -->
    <div class="page-header">
      <h1 class="page-title">é¡¹ç›®éœ€æ±‚æ”¶é›†è¡¨</h1>
      <p class="page-desc">è¯·è®¤çœŸå¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼Œä»¥ä¾¿æˆ‘ä»¬æ›´å¥½åœ°ç†è§£æ‚¨çš„éœ€æ±‚</p>
    </div>
    
    <!-- æç¤ºä¿¡æ¯ -->
    <div class="info-banner">
      <el-icon><InfoFilled /></el-icon>
      <span>æœ¬è¡¨å•æ”¯æŒéšæ—¶ä¿å­˜ï¼Œæ‚¨å¯ä»¥åˆ†å¤šæ¬¡å¡«å†™å®Œæˆ</span>
    </div>
    
    <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
    <el-steps :active="currentStep" finish-status="success" class="step-indicator" :simple="isMobile">
      <el-step title="é¡¹ç›®ä¿¡æ¯" />
      <el-step title="ç”¨æˆ·ç›¸å…³" />
      <el-step title="æ ¸å¿ƒåŠŸèƒ½" />
      <el-step title="ç®¡ç†åå°" />
      <el-step title="æ•°æ®ä¸æ”¯ä»˜" />
      <el-step title="è®¾è®¡ä¸æŠ€æœ¯" />
      <el-step title="æ—¶é—´é¢„ç®—" />
    </el-steps>
    
    <!-- è¡¨å•åŒºåŸŸ -->
    <div class="form-container card">
      <!-- æ­¥éª¤ 1: é¡¹ç›®ä¿¡æ¯ -->
      <div v-show="currentStep === 0" class="form-step">
        <h3 class="step-title">ä¸€ã€é¡¹ç›®åŸºæœ¬ä¿¡æ¯</h3>
        
        <el-form label-position="top">
          <el-form-item label="é¡¹ç›®èƒŒæ™¯" required>
            <el-input 
              v-model="form.background" 
              type="textarea" 
              :rows="3"
              placeholder="è¯·ç®€å•æè¿°æ‚¨æƒ³åšè¿™ä¸ªå°ç¨‹åºçš„åŸå› "
            />
          </el-form-item>
          
          <el-form-item label="å°ç¨‹åºåç§°" required>
            <el-input v-model="form.appName" placeholder="æ‚¨å¸Œæœ›å°ç¨‹åºå«ä»€ä¹ˆåå­—ï¼Ÿ" />
          </el-form-item>
          
          <el-form-item label="å°ç¨‹åºç±»å‹" required>
            <el-checkbox-group v-model="form.appType">
              <el-checkbox label="å·¥å…·ç±»">å·¥å…·ç±»ï¼ˆè®¡ç®—å™¨ã€è½¬æ¢å™¨ã€æŸ¥è¯¢å·¥å…·ç­‰ï¼‰</el-checkbox>
              <el-checkbox label="ç”µå•†ç±»">ç”µå•†ç±»ï¼ˆå•†å“å±•ç¤ºã€è´­ä¹°ã€è®¢å•ç®¡ç†ç­‰ï¼‰</el-checkbox>
              <el-checkbox label="ç¤¾åŒºç±»">ç¤¾åŒºç±»ï¼ˆå†…å®¹å‘å¸ƒã€è¯„è®ºã€äº’åŠ¨ç­‰ï¼‰</el-checkbox>
              <el-checkbox label="æœåŠ¡é¢„çº¦ç±»">æœåŠ¡é¢„çº¦ç±»ï¼ˆé¢„çº¦ã€æ’é˜Ÿã€ç­¾åˆ°ç­‰ï¼‰</el-checkbox>
              <el-checkbox label="ä¼ä¸šå±•ç¤ºç±»">ä¼ä¸šå±•ç¤ºç±»ï¼ˆå…¬å¸ä»‹ç»ã€è”ç³»æ–¹å¼ç­‰ï¼‰</el-checkbox>
              <el-checkbox label="æ´»åŠ¨æŠ¥åç±»">æ´»åŠ¨æŠ¥åç±»ï¼ˆæ´»åŠ¨å‘å¸ƒã€æŠ¥åã€ç®¡ç†ç­‰ï¼‰</el-checkbox>
            </el-checkbox-group>
            <el-input 
              v-model="form.appTypeOther" 
              placeholder="å…¶ä»–ç±»å‹ï¼ˆé€‰å¡«ï¼‰"
              class="other-input"
            />
          </el-form-item>
          
          <!-- â­ æ–°å¢ï¼šè”ç³»æ–¹å¼å’Œé¢„ç®—ä¿¡æ¯ï¼ˆé€‰å¡«ï¼‰ -->
          <el-divider content-position="left">
            <span style="color: var(--text-secondary); font-size: 14px;">
              è”ç³»æ–¹å¼ï¼ˆé€‰å¡«ï¼Œæ–¹ä¾¿æˆ‘ä»¬ä¸æ‚¨æ²Ÿé€šï¼‰
            </span>
          </el-divider>
          
          <el-form-item label="æ‚¨çš„è”ç³»æ–¹å¼">
            <el-input 
              v-model="form.contact" 
              placeholder="æ‰‹æœºå·æˆ–å¾®ä¿¡å·ï¼ˆé€‰å¡«ï¼‰"
            >
              <template #prefix>
                <el-icon><Phone /></el-icon>
              </template>
            </el-input>
            <div class="form-tip">ğŸ’¡ å¡«å†™åæˆ‘ä»¬èƒ½æ›´å¿«ä¸æ‚¨æ²Ÿé€šé¡¹ç›®ç»†èŠ‚</div>
          </el-form-item>
          
          <el-form-item label="é¢„ç®—èŒƒå›´">
            <el-input 
              v-model="form.budget" 
              placeholder="å¦‚ï¼š5000-10000å…ƒï¼ˆé€‰å¡«ï¼‰"
            >
              <template #prefix>
                <el-icon><Wallet /></el-icon>
              </template>
            </el-input>
            <div class="form-tip">ğŸ’¡ å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°è¯„ä¼°é¡¹ç›®è§„æ¨¡</div>
          </el-form-item>
          
          <el-form-item label="æœŸæœ›å®Œæˆæ—¶é—´">
            <el-input 
              v-model="form.expectedTime" 
              placeholder="å¦‚ï¼š2ä¸ªæœˆå†… æˆ– 3æœˆåº•å‰ï¼ˆé€‰å¡«ï¼‰"
            >
              <template #prefix>
                <el-icon><Calendar /></el-icon>
              </template>
            </el-input>
            <div class="form-tip">ğŸ’¡ å¸®åŠ©æˆ‘ä»¬åˆç†å®‰æ’å¼€å‘è¿›åº¦</div>
          </el-form-item>
        </el-form>
      </div>
      
      <!-- æ­¥éª¤ 2: ç”¨æˆ·ç›¸å…³ -->
      <div v-show="currentStep === 1" class="form-step">
        <h3 class="step-title">äºŒã€ç”¨æˆ·ç›¸å…³</h3>
        
        <el-form label-position="top">
          <el-form-item label="ä¸»è¦ç”¨æˆ·æ˜¯è°ï¼Ÿ" required>
            <el-input 
              v-model="form.targetUser" 
              type="textarea"
              :rows="2"
              placeholder="æè¿°ç”¨æˆ·ç‰¹å¾ï¼Œå¦‚ï¼š25-40å²çš„æ‘„å½±çˆ±å¥½è€…ï¼Œå–œæ¬¢æˆ·å¤–æ´»åŠ¨"
            />
          </el-form-item>
          
          <el-form-item label="ç”¨æˆ·ä½¿ç”¨åœºæ™¯" required>
            <el-input 
              v-model="form.userScenario" 
              type="textarea"
              :rows="2"
              placeholder="ç”¨æˆ·åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šæ‰“å¼€è¿™ä¸ªå°ç¨‹åºï¼Ÿæƒ³è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ"
            />
          </el-form-item>
          
          <el-form-item label="é¢„è®¡ç”¨æˆ·è§„æ¨¡">
            <el-radio-group v-model="form.userScale">
              <el-radio label="å°è§„æ¨¡">å°è§„æ¨¡ï¼ˆ&lt;100äººï¼‰</el-radio>
              <el-radio label="ä¸­ç­‰è§„æ¨¡">ä¸­ç­‰è§„æ¨¡ï¼ˆ100-1000äººï¼‰</el-radio>
              <el-radio label="è¾ƒå¤§è§„æ¨¡">è¾ƒå¤§è§„æ¨¡ï¼ˆ1000-10000äººï¼‰</el-radio>
              <el-radio label="å¤§è§„æ¨¡">å¤§è§„æ¨¡ï¼ˆ&gt;10000äººï¼‰</el-radio>
              <el-radio label="ä¸ç¡®å®š">ä¸ç¡®å®š</el-radio>
            </el-radio-group>
          </el-form-item>
        </el-form>
      </div>
      
      <!-- æ­¥éª¤ 3: æ ¸å¿ƒåŠŸèƒ½ -->
      <div v-show="currentStep === 2" class="form-step">
        <h3 class="step-title">ä¸‰ã€æ ¸å¿ƒåŠŸèƒ½</h3>
        
        <el-form label-position="top">
          <el-form-item label="å¿…é¡»è¦æœ‰çš„åŠŸèƒ½ï¼ˆP0ï¼‰" required>
            <div class="feature-tip">å¦‚æœåªèƒ½åš3ä¸ªåŠŸèƒ½ï¼Œæ‚¨æœ€æƒ³è¦å“ª3ä¸ªï¼Ÿ</div>
            <el-input 
              v-model="form.featuresP0" 
              type="textarea"
              :rows="4"
              placeholder="1. &#10;2. &#10;3. "
            />
          </el-form-item>
          
          <el-form-item label="å¸Œæœ›æœ‰çš„åŠŸèƒ½ï¼ˆP1ï¼‰">
            <div class="feature-tip">å¦‚æœæ—¶é—´å…è®¸ï¼Œè¿˜å¸Œæœ›åŠ å“ªäº›åŠŸèƒ½ï¼Ÿ</div>
            <el-input 
              v-model="form.featuresP1" 
              type="textarea"
              :rows="4"
              placeholder="1. &#10;2. &#10;3. "
            />
          </el-form-item>
          
          <el-form-item label="é”¦ä¸Šæ·»èŠ±çš„åŠŸèƒ½ï¼ˆP2ï¼‰">
            <div class="feature-tip">æœ‰äº†æ›´å¥½ï¼Œæ²¡æœ‰ä¹Ÿèƒ½æ¥å—çš„åŠŸèƒ½</div>
            <el-input 
              v-model="form.featuresP2" 
              type="textarea"
              :rows="3"
              placeholder="1. &#10;2. &#10;3. "
            />
          </el-form-item>
          
          <el-form-item label="æ˜¯å¦éœ€è¦ç”¨æˆ·ç™»å½•ï¼Ÿ" required>
            <el-radio-group v-model="form.needLogin">
              <el-radio label="å¿…é¡»ç™»å½•">éœ€è¦ï¼Œå¿…é¡»ç™»å½•æ‰èƒ½ä½¿ç”¨</el-radio>
              <el-radio label="éƒ¨åˆ†éœ€è¦">éœ€è¦ï¼Œä½†éƒ¨åˆ†åŠŸèƒ½å¯ä»¥ä¸ç™»å½•ä½¿ç”¨</el-radio>
              <el-radio label="ä¸éœ€è¦">ä¸éœ€è¦ï¼Œçº¯æµè§ˆå‹</el-radio>
              <el-radio label="ä¸ç¡®å®š">ä¸ç¡®å®š</el-radio>
            </el-radio-group>
          </el-form-item>
          
          <el-form-item label="ç™»å½•æ–¹å¼åå¥½" v-if="form.needLogin && form.needLogin !== 'ä¸éœ€è¦'">
            <el-checkbox-group v-model="form.loginType">
              <el-checkbox label="å¾®ä¿¡ä¸€é”®ç™»å½•">å¾®ä¿¡ä¸€é”®ç™»å½•ï¼ˆæœ€ç®€å•ï¼‰</el-checkbox>
              <el-checkbox label="æ‰‹æœºå·ç™»å½•">æ‰‹æœºå·ç™»å½•</el-checkbox>
              <el-checkbox label="è´¦å·å¯†ç ">è´¦å·å¯†ç ç™»å½•</el-checkbox>
            </el-checkbox-group>
          </el-form-item>
        </el-form>
      </div>
      
      <!-- æ­¥éª¤ 4: ç®¡ç†åå° -->
      <div v-show="currentStep === 3" class="form-step">
        <h3 class="step-title">å››ã€ç®¡ç†åå°</h3>
        
        <el-form label-position="top">
          <el-form-item label="æ˜¯å¦éœ€è¦ç®¡ç†åå°ï¼Ÿ" required>
            <el-radio-group v-model="form.needAdmin">
              <el-radio label="éœ€è¦">éœ€è¦ï¼ˆåœ¨ç”µè„‘ä¸Šç®¡ç†å†…å®¹ã€æŸ¥çœ‹æ•°æ®ç­‰ï¼‰</el-radio>
              <el-radio label="ä¸éœ€è¦">ä¸éœ€è¦ï¼ˆæ‰€æœ‰æ“ä½œåœ¨å°ç¨‹åºå†…å®Œæˆï¼‰</el-radio>
              <el-radio label="ä¸ç¡®å®š">ä¸ç¡®å®š</el-radio>
            </el-radio-group>
          </el-form-item>
          
          <template v-if="form.needAdmin === 'éœ€è¦'">
            <el-form-item label="ç®¡ç†åå°ä½¿ç”¨è€…">
              <el-input 
                v-model="form.adminUser" 
                placeholder="å¦‚:å…¬å¸è¿è¥äººå‘˜ï¼Œçº¦2-3äºº"
              />
            </el-form-item>
            
            <el-form-item label="ç®¡ç†åå°éœ€è¦å“ªäº›åŠŸèƒ½ï¼Ÿ">
              <el-input 
                v-model="form.adminFeatures" 
                type="textarea"
                :rows="3"
                placeholder="å¦‚ï¼šå‘å¸ƒæ´»åŠ¨ã€æŸ¥çœ‹æŠ¥ååå•ã€å¯¼å‡ºExcelã€æ•°æ®ç»Ÿè®¡"
              />
            </el-form-item>
          </template>
        </el-form>
      </div>
      
      <!-- æ­¥éª¤ 5: æ•°æ®ä¸æ”¯ä»˜ -->
      <div v-show="currentStep === 4" class="form-step">
        <h3 class="step-title">äº”ã€æ•°æ®ä¸æ”¯ä»˜</h3>
        
        <el-form label-position="top">
          <el-form-item label="éœ€è¦å­˜å‚¨å“ªäº›æ•°æ®ï¼Ÿ">
            <el-input 
              v-model="form.dataStorage" 
              type="textarea"
              :rows="3"
              placeholder="å¦‚ï¼šç”¨æˆ·ä¿¡æ¯ã€æ´»åŠ¨ä¿¡æ¯ã€æŠ¥åè®°å½•ã€è®¢å•è®°å½•"
            />
          </el-form-item>
          
          <el-form-item label="å†…å®¹ä»å“ªé‡Œæ¥ï¼Ÿ">
            <el-checkbox-group v-model="form.contentSource">
              <el-checkbox label="ç®¡ç†å‘˜å‘å¸ƒ">ç®¡ç†å‘˜åœ¨åå°å‘å¸ƒ</el-checkbox>
              <el-checkbox label="ç”¨æˆ·ç”Ÿæˆ">ç”¨æˆ·è‡ªå·±ç”Ÿæˆï¼ˆUGCï¼‰</el-checkbox>
              <el-checkbox label="ç³»ç»Ÿå¯¼å…¥">ä»å…¶ä»–ç³»ç»Ÿå¯¼å…¥</el-checkbox>
              <el-checkbox label="å¤–éƒ¨è·å–">å®æ—¶ä»å¤–éƒ¨è·å–</el-checkbox>
            </el-checkbox-group>
          </el-form-item>
          
          <el-form-item label="æ˜¯å¦éœ€è¦å¯¼å…¥å¯¼å‡ºåŠŸèƒ½ï¼Ÿ">
            <el-checkbox-group v-model="form.importExport">
              <el-checkbox label="å¯¼å…¥">éœ€è¦å¯¼å…¥ï¼ˆä»Excelç­‰å¯¼å…¥æ•°æ®ï¼‰</el-checkbox>
              <el-checkbox label="å¯¼å‡º">éœ€è¦å¯¼å‡ºï¼ˆå¯¼å‡ºExcelæŠ¥è¡¨ï¼‰</el-checkbox>
            </el-checkbox-group>
          </el-form-item>
          
          <el-divider />
          
          <el-form-item label="æ˜¯å¦æ¶‰åŠæ”¯ä»˜ï¼Ÿ" required>
            <el-radio-group v-model="form.needPayment">
              <el-radio label="éœ€è¦å¾®ä¿¡æ”¯ä»˜">æ˜¯ï¼Œéœ€è¦å¾®ä¿¡æ”¯ä»˜</el-radio>
              <el-radio label="ä»…å±•ç¤ºä»·æ ¼">æ˜¯ï¼Œä½†åªæ˜¯å±•ç¤ºä»·æ ¼ï¼Œçº¿ä¸‹æ”¯ä»˜</el-radio>
              <el-radio label="ä¸éœ€è¦">å¦ï¼Œå®Œå…¨å…è´¹</el-radio>
            </el-radio-group>
          </el-form-item>
          
          <template v-if="form.needPayment === 'éœ€è¦å¾®ä¿¡æ”¯ä»˜'">
            <el-form-item label="æ”¯ä»˜åœºæ™¯">
              <el-input 
                v-model="form.paymentScenario" 
                placeholder="å¦‚ï¼šç”¨æˆ·æŠ¥åæ´»åŠ¨æ—¶æ”¯ä»˜æ´»åŠ¨è´¹ç”¨"
              />
            </el-form-item>
            
            <el-form-item label="æ˜¯å¦éœ€è¦é€€æ¬¾åŠŸèƒ½ï¼Ÿ">
              <el-radio-group v-model="form.needRefund">
                <el-radio label="éœ€è¦">éœ€è¦</el-radio>
                <el-radio label="ä¸éœ€è¦">ä¸éœ€è¦</el-radio>
                <el-radio label="ä¸ç¡®å®š">ä¸ç¡®å®š</el-radio>
              </el-radio-group>
            </el-form-item>
          </template>
        </el-form>
      </div>
      
      <!-- æ­¥éª¤ 6: è®¾è®¡ä¸æŠ€æœ¯ -->
      <div v-show="currentStep === 5" class="form-step">
        <h3 class="step-title">å…­ã€è®¾è®¡ä¸æŠ€æœ¯</h3>
        
        <el-form label-position="top">
          <el-form-item label="æœ‰æ²¡æœ‰å‚è€ƒçš„å°ç¨‹åºæˆ–Appï¼Ÿ">
            <el-input 
              v-model="form.reference" 
              type="textarea"
              :rows="2"
              placeholder="æ‚¨è§‰å¾—å“ªä¸ªå°ç¨‹åº/Appçš„è®¾è®¡æˆ–åŠŸèƒ½åšå¾—å¥½ï¼Ÿ"
            />
          </el-form-item>
          
          <el-form-item label="UIé£æ ¼åå¥½">
            <el-radio-group v-model="form.uiStyle">
              <el-radio label="ç®€çº¦æ¸…çˆ½">ç®€çº¦æ¸…çˆ½</el-radio>
              <el-radio label="ç§‘æŠ€æ„Ÿæ·±è‰²">ç§‘æŠ€æ„Ÿ/æ·±è‰²</el-radio>
              <el-radio label="æ´»æ³¼å¯çˆ±">æ´»æ³¼å¯çˆ±</el-radio>
              <el-radio label="å•†åŠ¡ä¸“ä¸š">å•†åŠ¡ä¸“ä¸š</el-radio>
              <el-radio label="æ— ç‰¹åˆ«è¦æ±‚">æ²¡æœ‰ç‰¹åˆ«è¦æ±‚</el-radio>
            </el-radio-group>
          </el-form-item>
          
          <el-form-item label="ä¸»è‰²è°ƒåå¥½">
            <el-input 
              v-model="form.colorPreference" 
              placeholder="å“ç‰Œè‰²/ä¸»è‰²ã€è¾…åŠ©è‰²ï¼ˆå¦‚æœæ²¡æœ‰è¦æ±‚å¯ä»¥ç•™ç©ºï¼‰"
            />
          </el-form-item>
          
          <el-divider />
          
          <el-form-item label="æ˜¯å¦å·²æœ‰å¾®ä¿¡å°ç¨‹åºè´¦å·ï¼Ÿ">
            <el-radio-group v-model="form.hasAppId">
              <el-radio label="æœ‰">æœ‰ï¼Œå·²æ³¨å†Œ</el-radio>
              <el-radio label="æ²¡æœ‰">æ²¡æœ‰ï¼Œéœ€è¦å¸®å¿™æ³¨å†Œ</el-radio>
              <el-radio label="ä¸ç¡®å®š">ä¸ç¡®å®š</el-radio>
            </el-radio-group>
          </el-form-item>
          
          <el-form-item label="AppID" v-if="form.hasAppId === 'æœ‰'">
            <el-input v-model="form.appId" placeholder="è¯·è¾“å…¥ AppID" />
          </el-form-item>
          
          <el-form-item label="åç«¯æœåŠ¡åå¥½">
            <el-radio-group v-model="form.backend">
              <el-radio label="äº‘å¼€å‘">å¾®ä¿¡äº‘å¼€å‘ï¼ˆæ¨èï¼Œçœå¿ƒçœé’±ï¼‰</el-radio>
              <el-radio label="è‡ªæœ‰æœåŠ¡å™¨">æœ‰è‡ªå·±çš„æœåŠ¡å™¨</el-radio>
              <el-radio label="ä¸ç¡®å®š">ä¸ç¡®å®šï¼Œéœ€è¦å»ºè®®</el-radio>
            </el-radio-group>
          </el-form-item>
        </el-form>
      </div>
      
      <!-- æ­¥éª¤ 7: æ—¶é—´é¢„ç®— -->
      <div v-show="currentStep === 6" class="form-step">
        <h3 class="step-title">ä¸ƒã€æ—¶é—´ä¸é¢„ç®—</h3>
        
        <el-form label-position="top">
          <el-form-item label="æœŸæœ›çš„ä¸Šçº¿æ—¶é—´">
            <el-input 
              v-model="form.timeline" 
              placeholder="å¦‚ï¼šå¸Œæœ›1ä¸ªæœˆå†…ä¸Šçº¿ï¼Œæœ€æ™šä¸è¶…è¿‡2ä¸ªæœˆ"
            />
          </el-form-item>
          
          <el-form-item label="é¢„ç®—èŒƒå›´">
            <el-radio-group v-model="form.budget">
              <el-radio label="<5000">< 5000å…ƒ</el-radio>
              <el-radio label="5000-10000">5000-10000å…ƒ</el-radio>
              <el-radio label="10000-30000">10000-30000å…ƒ</el-radio>
              <el-radio label="30000-50000">30000-50000å…ƒ</el-radio>
              <el-radio label=">50000">> 50000å…ƒ</el-radio>
              <el-radio label="çœ‹åŠŸèƒ½å®š">çœ‹åŠŸèƒ½å®š</el-radio>
            </el-radio-group>
          </el-form-item>
          
          <el-form-item label="åç»­è¿è¥æˆæœ¬é¢„æœŸï¼ˆæœˆï¼‰">
            <el-radio-group v-model="form.operationCost">
              <el-radio label="å…è´¹">å°½é‡å…è´¹</el-radio>
              <el-radio label="<100">< 100å…ƒ/æœˆ</el-radio>
              <el-radio label="100-500">100-500å…ƒ/æœˆ</el-radio>
              <el-radio label=">500">> 500å…ƒ/æœˆ</el-radio>
              <el-radio label="ä¸ç¡®å®š">ä¸ç¡®å®š</el-radio>
            </el-radio-group>
          </el-form-item>
          
          <el-divider />
          
          <el-form-item label="è”ç³»æ–¹å¼" required>
            <el-input 
              v-model="form.contact" 
              placeholder="è¯·ç•™ä¸‹æ‚¨çš„å¾®ä¿¡/æ‰‹æœº/é‚®ç®±ï¼Œä»¥ä¾¿æˆ‘ä»¬è”ç³»æ‚¨"
            />
          </el-form-item>
          
          <el-form-item label="å…¶ä»–éœ€è¦è¯´æ˜çš„äº‹é¡¹">
            <el-input 
              v-model="form.otherNotes" 
              type="textarea"
              :rows="4"
              placeholder="ä»»ä½•å…¶ä»–æƒ³è¯´çš„å†…å®¹..."
            />
          </el-form-item>
        </el-form>
      </div>
      
      <!-- æ“ä½œæŒ‰é’® -->
      <div class="form-actions">
        <el-button v-if="currentStep > 0" @click="prevStep">
          <el-icon><ArrowLeft /></el-icon>
          ä¸Šä¸€æ­¥
        </el-button>
        <div class="actions-right">
          <el-button @click="saveDraft">
            <el-icon><DocumentCopy /></el-icon>
            ä¿å­˜è‰ç¨¿
          </el-button>
          <el-button v-if="currentStep < 6" type="primary" @click="nextStep">
            ä¸‹ä¸€æ­¥
            <el-icon><ArrowRight /></el-icon>
          </el-button>
          <el-button v-else type="primary" @click="submitForm">
            <el-icon><Check /></el-icon>
            æäº¤
          </el-button>
        </div>
      </div>
    </div>
    
    <!-- æäº¤æˆåŠŸæç¤º -->
    <el-dialog v-model="submitSuccess" title="æäº¤æˆåŠŸ" width="90%" :close-on-click-modal="false">
      <div class="success-content">
        <el-result icon="success" title="éœ€æ±‚æ”¶é›†å®Œæˆ" sub-title="æ„Ÿè°¢æ‚¨çš„å¡«å†™ï¼æˆ‘ä»¬ä¼šå°½å¿«ä¸æ‚¨è”ç³»ã€‚">
          <template #extra>
            <div class="submit-id">
              <p>æ‚¨çš„æäº¤IDï¼š<strong>{{ submissionId }}</strong></p>
              <p class="hint">è¯·ä¿å­˜æ­¤IDï¼Œä»¥ä¾¿åç»­æŸ¥è¯¢</p>
            </div>
          </template>
        </el-result>
      </div>
      <template #footer>
        <el-button type="primary" @click="copySubmissionId">å¤åˆ¶ID</el-button>
        <el-button @click="resetForm">å¡«å†™æ–°éœ€æ±‚</el-button>
      </template>
    </el-dialog>
  </div>
</template>

<script setup>
import { ref, reactive, computed, onMounted } from 'vue'
import { ElMessage } from 'element-plus'
import { Phone, Wallet, Calendar } from '@element-plus/icons-vue'  // â­ æ–°å¢å›¾æ ‡

const currentStep = ref(0)
const submitSuccess = ref(false)
const submissionId = ref('')
const isMobile = ref(false)

// è¡¨å•æ•°æ®
const form = reactive({
  background: '',
  appName: '',
  appType: [],
  appTypeOther: '',
  contact: '',  // â­ è”ç³»æ–¹å¼
  budget: '',  // â­ é¢„ç®—
  expectedTime: '',  // â­ æ–°å¢ï¼šæœŸæœ›å®Œæˆæ—¶é—´
  targetUser: '',
  userScenario: '',
  userScale: '',
  featuresP0: '',
  featuresP1: '',
  featuresP2: '',
  needLogin: '',
  loginType: [],
  needAdmin: '',
  adminUser: '',
  adminFeatures: '',
  dataStorage: '',
  contentSource: [],
  importExport: [],
  needPayment: '',
  paymentScenario: '',
  needRefund: '',
  reference: '',
  uiStyle: '',
  colorPreference: '',
  hasAppId: '',
  appId: '',
  backend: '',
  timeline: '',
  operationCost: '',
  otherNotes: ''
})

onMounted(() => {
  // æ£€æµ‹æ˜¯å¦æ˜¯ç§»åŠ¨è®¾å¤‡
  isMobile.value = window.innerWidth < 768
  
  // å°è¯•åŠ è½½è‰ç¨¿
  const draft = localStorage.getItem('public_requirement_draft')
  if (draft) {
    try {
      Object.assign(form, JSON.parse(draft))
      ElMessage.info('å·²åŠ è½½ä¸Šæ¬¡ä¿å­˜çš„è‰ç¨¿')
    } catch (e) {
      console.error('åŠ è½½è‰ç¨¿å¤±è´¥', e)
    }
  }
})

function nextStep() {
  // ç®€å•éªŒè¯
  if (currentStep.value === 0) {
    if (!form.background || !form.appName || form.appType.length === 0) {
      ElMessage.warning('è¯·å¡«å†™é¡¹ç›®åŸºæœ¬ä¿¡æ¯ä¸­çš„å¿…å¡«é¡¹')
      return
    }
  } else if (currentStep.value === 1) {
    if (!form.targetUser || !form.userScenario) {
      ElMessage.warning('è¯·å¡«å†™ç”¨æˆ·ç›¸å…³çš„å¿…å¡«é¡¹')
      return
    }
  } else if (currentStep.value === 2) {
    if (!form.featuresP0 || !form.needLogin) {
      ElMessage.warning('è¯·å¡«å†™æ ¸å¿ƒåŠŸèƒ½çš„å¿…å¡«é¡¹')
      return
    }
  } else if (currentStep.value === 3) {
    if (!form.needAdmin) {
      ElMessage.warning('è¯·é€‰æ‹©æ˜¯å¦éœ€è¦ç®¡ç†åå°')
      return
    }
  } else if (currentStep.value === 4) {
    if (!form.needPayment) {
      ElMessage.warning('è¯·é€‰æ‹©æ˜¯å¦æ¶‰åŠæ”¯ä»˜')
      return
    }
  } else if (currentStep.value === 6) {
    if (!form.contact) {
      ElMessage.warning('è¯·å¡«å†™è”ç³»æ–¹å¼')
      return
    }
  }
  
  if (currentStep.value < 6) {
    currentStep.value++
    saveDraft()
  }
}

function prevStep() {
  if (currentStep.value > 0) {
    currentStep.value--
  }
}

function saveDraft() {
  try {
    localStorage.setItem('public_requirement_draft', JSON.stringify(form))
    ElMessage.success('è‰ç¨¿å·²ä¿å­˜')
  } catch (e) {
    ElMessage.error('ä¿å­˜å¤±è´¥')
  }
}

function submitForm() {
  // â­ ä¸å†å¼ºåˆ¶è¦æ±‚è”ç³»æ–¹å¼
  if (!form.appName || !form.background) {
    ElMessage.warning('è¯·è‡³å°‘å¡«å†™é¡¹ç›®åç§°å’ŒèƒŒæ™¯')
    currentStep.value = 0
    return
  }
  
  // ç”Ÿæˆæäº¤ID
  submissionId.value = 'REQ-' + Date.now() + '-' + Math.random().toString(36).substr(2, 6).toUpperCase()
  
  // â­ ç›´æ¥ä¿å­˜åˆ°éœ€æ±‚æ± 
  const requirementPool = JSON.parse(localStorage.getItem('requirement-pool') || '[]')
  const requirement = {
    id: submissionId.value,
    submittedAt: new Date().toISOString(),
    status: 'pending',
    data: { ...form },
    projectId: null,
    notes: '',
    tags: [],
    quickInfo: {
      appName: form.appName || 'æœªå‘½åé¡¹ç›®',
      budget: form.budget || null,
      contact: form.contact ? maskContact(form.contact) : null,
      expectedTime: form.expectedTime || null,
      hasContact: !!form.contact,
      hasBudget: !!form.budget,
      hasTime: !!form.expectedTime
    }
  }
  
  requirementPool.unshift(requirement)
  localStorage.setItem('requirement-pool', JSON.stringify(requirementPool))
  
  // æ¸…é™¤è‰ç¨¿
  localStorage.removeItem('public_requirement_draft')
  
  submitSuccess.value = true
}

// â­ æ–°å¢ï¼šé®è”½è”ç³»æ–¹å¼
function maskContact(contact) {
  if (!contact) return null
  // æ‰‹æœºå·ï¼š138****8888
  if (/^1\d{10}$/.test(contact)) {
    return contact.replace(/(\d{3})\d{4}(\d{4})/, '$1****$2')
  }
  // å…¶ä»–ï¼šæ˜¾ç¤ºå‰3ä½å’Œæœ€å2ä½
  if (contact.length > 5) {
    return contact.slice(0, 3) + '****' + contact.slice(-2)
  }
  return contact
}

function copySubmissionId() {
  navigator.clipboard.writeText(submissionId.value)
  ElMessage.success('IDå·²å¤åˆ¶åˆ°å‰ªè´´æ¿')
}

function resetForm() {
  Object.keys(form).forEach(key => {
    if (Array.isArray(form[key])) {
      form[key] = []
    } else {
      form[key] = ''
    }
  })
  currentStep.value = 0
  submitSuccess.value = false
  submissionId.value = ''
  ElMessage.info('è¡¨å•å·²é‡ç½®')
}
</script>

<style scoped>
.public-requirement-page {
  max-width: 900px;
  margin: 0 auto;
  padding: 20px;
  min-height: 100vh;
  background: var(--bg-secondary);
}

.page-header {
  text-align: center;
  margin-bottom: 24px;
}

.page-title {
  font-size: 28px;
  font-weight: 700;
  color: var(--primary-color);
  margin-bottom: 8px;
}

.page-desc {
  color: var(--text-secondary);
  font-size: 14px;
}

.info-banner {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 16px;
  background: rgba(212, 175, 55, 0.1);
  border: 1px solid rgba(212, 175, 55, 0.3);
  border-radius: 8px;
  color: var(--primary-color);
  margin-bottom: 24px;
  font-size: 14px;
}

.step-indicator {
  margin-bottom: 24px;
  padding: 20px;
  background: var(--bg-card);
  border-radius: 12px;
}

.form-container {
  margin-bottom: 24px;
  padding: 24px;
}

.form-step {
  min-height: 400px;
}

.step-title {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 24px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border-color);
  color: var(--primary-color);
}

.other-input {
  margin-top: 12px;
}

.feature-tip {
  font-size: 12px;
  color: var(--text-muted);
  margin-bottom: 8px;
}

.form-actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 20px;
  border-top: 1px solid var(--border-color);
  margin-top: 24px;
}

.actions-right {
  display: flex;
  gap: 12px;
}

.success-content {
  text-align: center;
}

.submit-id {
  margin-top: 20px;
}

.submit-id p {
  margin: 8px 0;
  color: var(--text-primary);
}

.submit-id strong {
  color: var(--primary-color);
  font-size: 18px;
}

.submit-id .hint {
  font-size: 12px;
  color: var(--text-muted);
}

:deep(.el-checkbox),
:deep(.el-radio) {
  display: flex;
  margin-bottom: 8px;
  height: auto;
  white-space: normal;
}

:deep(.el-checkbox-group),
:deep(.el-radio-group) {
  display: flex;
  flex-direction: column;
}

/* ç§»åŠ¨ç«¯ä¼˜åŒ– */
@media (max-width: 768px) {
  .public-requirement-page {
    padding: 12px;
  }
  
  .page-title {
    font-size: 22px;
  }
  
  .form-container {
    padding: 16px;
  }
  
  .form-actions {
    flex-direction: column;
    gap: 12px;
  }
  
  .actions-right {
    width: 100%;
    flex-direction: column;
  }
  
  .actions-right .el-button {
    width: 100%;
  }
}
</style>
